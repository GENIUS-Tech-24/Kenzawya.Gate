<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>مشروعات الكنزاوية | بوابة الكنزاوية</title>
<meta name="description" content="منصة لاستعراض مشاريع وخدمات سكان الكمبوند مع إمكانية البحث والتصفية وطلب إضافة مشروع جديد."/>
<link href="../styles.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>

<style>
:root{
  --header-height:90px;
  --toolbar-radius:14px;
  --toolbar-bg:#ffffff;
  --radius-pill:40px;
  /* إعدادات تأثير اللمعان (الديسكتوب) */
  --reflect-speed:4.8s;
  --reflect-angle:120deg;
  --reflect-width:180%;
  --reflect-intensity:0.68;
  --reflect-active-boost:0.85;
}

/* تقليل الحركة لذوي الاحتياج */
@media (prefers-reduced-motion:reduce){
  :root{ --reflect-speed:0s; }
}

/* ضبط box-sizing لمنع أي تمدد غير محسوب */
*,*::before,*::after{ box-sizing:border-box; }

body{
  font-family:'Cairo',system-ui,sans-serif;
  background:#f5f9fc;
  margin:0;
  color:#1d3342;
}

/* الهيدر */
.header{
  position:fixed; top:0; right:0; left:0; z-index:1000;
  background:#4a90e2;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
  padding:14px 0 10px;
}
.logo{padding:0 26px;}
.logo h1{margin:0;font-size:2rem;color:#f9fdff;font-weight:700;line-height:1.05;}
.logo p{margin:4px 0 0;color:#e8f5ff;font-size:1rem;font-weight:500;}

/* المحتوى */
.main-content{
  max-width:1000px;
  margin:0 auto;
  padding:calc(var(--header-height) + 12px) 18px 80px;
  box-sizing:border-box;
}

.section-card{
  background:linear-gradient(120deg,#e6f7ff 70%,#f0f2f5 100%);
  margin-top:12px;
  box-shadow:0 8px 28px rgba(74,144,226,.13);
  padding:26px 28px 34px;
  border-radius:22px;
}

h2.page-title{
  margin:0 0 14px;
  font-size:1.65rem;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  font-weight:800;
  color:#1e6397;
  text-align:center;
}
p.page-intro{
  margin:0 0 22px;
  font-size:.98rem;
  line-height:1.7;
  color:#31444f;
  max-width:820px;
}

/* شريط الأدوات */
.projects-toolbar{
  display:flex;
  align-items:center;
  flex-wrap:wrap;
  gap:14px;
  background:var(--toolbar-bg);
  padding:14px 16px;
  border-radius:var(--toolbar-radius);
  box-shadow:0 4px 16px rgba(0,0,0,.06);
  position:relative;
  overflow:hidden; /* لمنع أي تأثر للّمعان */
}

.search-box{
  display:flex;align-items:center;gap:8px;
  background:#f3f8fb;border:1px solid #d2dde6;
  height:46px;padding:0 16px;border-radius:34px;
  flex:1 1 320px;min-width:240px;overflow:hidden;
}
.search-box i{font-size:.9rem;color:#3782b7;}
.search-box input{
  border:0;outline:none;background:transparent;
  width:100%;height:100%;
  font:inherit;font-size:.85rem;
}
.search-box input::placeholder{color:#5c7487;opacity:.75;font-size:.82rem;}

/* فلاتر الديسكتوب (أساس) */
.filters{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  flex:1 1 100%;
  margin:0;
  padding:0;
  list-style:none;
  position:relative;
  overflow:visible;
}

.filter-btn{
  --btn-bg:#ffffff;
  position:relative;
  overflow:hidden;
  background:var(--btn-bg);
  border:1px solid #cfdbe5;
  padding:7px 13px 8px;
  font-size:.68rem;
  letter-spacing:.3px;
  border-radius:18px;
  cursor:pointer;
  color:#2d5d84;
  font-weight:600;
  transition:background .18s, color .18s, border-color .18s, box-shadow .25s;
  display:inline-flex;
  align-items:center;
  gap:5px;
  line-height:1.1;
  white-space:nowrap;
  justify-content:center;
  isolation:isolate;
}
.filter-btn i{font-size:.78rem;opacity:.85;}
.filter-btn:hover{background:#f0f7fc;}
.filter-btn.active{
  background:#4a90e2;
  color:#fff;
  border-color:#4a90e2;
  box-shadow:0 4px 14px -2px rgba(74,144,226,.45);
}

/* تأثير اللمعان (Reflect) للديسكتوب */
.filter-btn.reflect::before,
.filter-btn.reflect::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
}

.filter-btn.reflect::after{
  --alpha:var(--reflect-intensity);
  background:
    linear-gradient(
      var(--reflect-angle),
      rgba(255,255,255,0) 0%,
      rgba(255,255,255,0) 40%,
      rgba(255,255,255,var(--alpha)) 50%,
      rgba(255,255,255,0) 60%,
      rgba(255,255,255,0) 100%);
  width:var(--reflect-width);
  top:0; bottom:0;
  right:-90%;
  mix-blend-mode:screen;
  animation:reflect-sweep var(--reflect-speed) linear infinite;
  transform:skewX(-18deg);
  opacity:.9;
}
.filter-btn.reflect.active::after{
  --alpha:var(--reflect-active-boost);
  animation-duration:calc(var(--reflect-speed)*0.75);
}
.filter-btn.reflect:hover::after{
  animation-duration:calc(var(--reflect-speed)*0.6);
}
@keyframes reflect-sweep{
  0%   { right:-95%; }
  55%  { right:105%; }
  100% { right:105%; }
}
.filter-btn.reflect::before{
  background:radial-gradient(circle at 25% 50%,rgba(255,255,255,.55),rgba(255,255,255,0) 60%);
  opacity:.35;
  filter:blur(6px);
  animation:reflect-glow calc(var(--reflect-speed)*2.2) ease-in-out infinite;
}
.filter-btn.reflect.active::before{opacity:.55;animation-duration:calc(var(--reflect-speed)*1.8);}
@keyframes reflect-glow{
  0%,100%{background-position:0% 50%;opacity:.28;}
  50%{background-position:70% 50%;opacity:.5;}
}
.filter-btn.reflect.no-reflect::after,
.filter-btn.reflect.no-reflect::before{display:none;}

.add-wrapper{margin-inline-start:auto;display:flex;align-items:center;}
.btn{
  display:inline-flex;align-items:center;gap:6px;
  background:#4a90e2;color:#fff;border:0;
  padding:10px 16px 11px;font-size:.8rem;font-weight:700;
  border-radius:10px;cursor:pointer;box-shadow:0 4px 14px rgba(74,144,226,.35);
  text-decoration:none;letter-spacing:.25px;transition:.18s;white-space:nowrap;
}
.btn:hover{background:#3579c6;}
.btn-outline{background:#fff;color:#4a90e2;border:1px solid #b9d4ec;box-shadow:none;}
.btn-outline:hover{background:#e6f3fd;}

/* الشبكة */
.projects-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:22px;
  margin-top:28px;
}
.project-card{
  background:#fff;
  border-radius:18px;
  box-shadow:0 6px 18px rgba(0,0,0,.07);
  display:flex;
  flex-direction:column;
  overflow:hidden;
  transition:.22s;
}
.project-card:hover{box-shadow:0 10px 30px rgba(74,144,226,.2);transform:translateY(-3px);}
.project-media{
  aspect-ratio:4/3;
  background:#eef6ff;
  overflow:hidden;
}
.project-media img{width:100%;height:100%;object-fit:cover;display:block;}
.project-body{
  padding:14px 16px 16px;
  display:flex;
  flex-direction:column;
  flex:1;
}
.project-body h3{
  margin:0 0 6px;
  font-size:1.02rem;
  color:#276399;
  line-height:1.3;
  font-weight:700;
  text-align:center;
}
.project-body p{
  margin:0 0 14px;
  font-size:.78rem;
  line-height:1.5;
  color:#5f6d78;
  min-height:40px;
  text-align:center;
}

/* الصف السفلي */
.meta-row{
  margin-top:auto;
  display:flex;
  flex-direction:column;
  gap:8px;
  align-items:center;
  width:100%;
}

.category-badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:.68rem;
  font-weight:700;
  letter-spacing:.4px;
  padding:7px 14px 8px;
  border-radius:var(--radius-pill);
  line-height:1.1;
  background:linear-gradient(135deg,#eef6ff,#d5e9fa);
  color:#1d5d92;
  box-shadow:0 3px 10px rgba(0,0,0,.05),0 0 0 1px #c6dced inset;
  white-space:nowrap;
}
.category-badge i{font-size:.85rem;color:#1d74b8;}
.category-badge.food{background:linear-gradient(135deg,#fff4e2,#ffd7a3);color:#8a4d07;box-shadow:0 0 0 1px #f4c48a inset;}
.category-badge.agri{background:linear-gradient(135deg,#e9fbe9,#c8efcc);color:#1d6a2c;box-shadow:0 0 0 1px #b6dfba inset;}
.category-badge.kids{background:linear-gradient(135deg,#fdefff,#fbd2ff);color:#7a207f;box-shadow:0 0 0 1px #eab0f0 inset;}

.contact-group{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  align-items:center;
  justify-content:center;
  direction:ltr;
}
.contact-group .lbl-ar{direction:rtl;unicode-bidi:isolate;}
.contact-btn{
  --btn-font:.63rem;
  display:inline-flex;
  align-items:center;
  gap:6px;
  font-size:var(--btn-font);
  font-weight:700;
  line-height:1.1;
  text-decoration:none;
  padding:7px 12px 8px;
  border-radius:12px;
  background:#f1f5f9;
  color:#1e465d;
  transition:.18s;
  box-shadow:0 2px 4px rgba(0,0,0,.06);
  direction:ltr;
  font-variant-numeric:tabular-nums;
}
.contact-btn:hover{background:#e2edf4;}
.contact-btn i{font-size:.85rem;line-height:1;}
.contact-btn.phone{background:#eef6ff;color:#1d5d92;box-shadow:0 2px 6px rgba(29,93,146,.18);}
.contact-btn.phone:hover{background:#dbeeff;}
.contact-btn.wa{background:#25D366;color:#fff;box-shadow:0 3px 10px rgba(37,211,102,.35);}
.contact-btn.wa:hover{background:#1db655;}
.contact-btn.fb{background:#1877F2;color:#fff;box-shadow:0 3px 10px rgba(24,119,242,.35);}
.contact-btn.fb:hover{background:#0f65d5;}
.contact-btn .num{direction:ltr;unicode-bidi:embed;white-space:nowrap;letter-spacing:.5px;}

/* ديسكتوب: ترتيب شارة + اتصالات */
@media (min-width:760px){
  .meta-row{
    flex-direction:row;
    justify-content:space-between;
    align-items:center;
  }
  .contact-group{justify-content:flex-start;}
}

/* ========== الموبايل (العلاج لمنع خروج الأزرار) ========== */
@media (max-width:640px){
  :root{--header-height:84px;}

  .logo{padding:0 18px;}
  .logo h1{font-size:1.55rem;}
  .logo p{font-size:.85rem;margin-top:2px;}
  .section-card{padding:22px 18px 30px;}
  h2.page-title{font-size:1.45rem;}
  p.page-intro{font-size:.9rem;margin-bottom:18px;}

  .projects-toolbar{
    flex-direction:column;
    align-items:stretch;
    gap:10px;
    padding:12px 14px 14px;
    overflow:hidden; /* يمنع أي نزيف بصري */
  }

  .search-box{
    width:100%;min-width:0;flex:none;
    height:40px;padding:0 14px;border-radius:28px;
  }
  .search-box input{font-size:.75rem;}
  .search-box input::placeholder{font-size:.72rem;}

  /* أهم التعديلات */
  .filters{
    display:flex;
    flex-wrap:wrap;
    gap:8px 10px;
    width:100%;
    overflow:hidden;
  }

  .filter-btn{
    flex:1 1 calc(50% - 10px);          /* عمودان */
    max-width:calc(50% - 10px);
    font-size:.7rem;
    padding:8px 10px 9px;
    border-radius:18px;
    white-space:normal;                 /* يسمح لكسر السطر */
    line-height:1.25;
    word-wrap:break-word;
    word-break:break-word;
  }

  /* شاشات أضيق: عمود واحد */
  @media (max-width:380px){
    .filter-btn{
      flex:1 1 100%;
      max-width:100%;
    }
  }

  /* تخفيض تأثير اللمعان حتى لا يبدو خارج الحافة */
  .filter-btn.reflect::after{
    width:140%;
    right:-110%;
    --alpha:.5;
    animation-duration:6s;
  }
  .filter-btn.reflect.active::after{
    --alpha:.7;
    animation-duration:4.2s;
  }
  .filter-btn.reflect::before{
    opacity:.22;
    filter:blur(5px);
  }

  #toggleFormBtn{
    width:100%;justify-content:center;
    font-size:.9rem;padding:8px 12px 9px;
  }

  .project-media{aspect-ratio:16/10;}
  .contact-btn{font-size:.6rem;padding:6px 10px 7px;}
  .category-badge{font-size:.63rem;padding:6px 12px 7px;}
}

@media (max-width:400px){
  :root{--header-height:82px;}
  .search-box{height:38px;padding:0 12px;}
  .search-box input{font-size:.7rem;}
  .filter-btn{font-size:.65rem;}
  .projects-grid{gap:18px;}
}

.empty-state{
  background:linear-gradient(180deg,#ffffff,#f0f7fc);
  padding:30px 26px;
  border-radius:18px;
  text-align:center;
  color:#5d7080;
  font-size:.9rem;
  margin-top:34px;
  box-shadow:0 6px 18px rgba(0,0,0,0.05);
  display:none;
}

.note{
  margin-top:26px;
  font-size:.72rem;
  color:#4a5b66;
  background:#fff;
  padding:10px 14px;
  border-radius:10px;
  display:flex;
  align-items:center;
  gap:8px;
  box-shadow:0 2px 10px rgba(0,0,0,.05);
}
.note i{color:#4a90e2;}

/* نموذج الطلب */
#submit-project{
  margin-top:42px;
  background:#ffffff;
  border:1px solid #d5e4ef;
  padding:0;
  border-radius:18px;
  box-shadow:0 8px 22px rgba(0,0,0,0.06);
  overflow:hidden;
  transition:height .45s cubic-bezier(.4,.8,.3,1), opacity .35s ease;
}
#submit-project[hidden]{display:block;height:0!important;padding:0!important;opacity:0;border:0;box-shadow:none;}
#submit-project .inner{padding:26px 24px 30px;}
#submit-project h3{
  margin:0 0 14px;
  font-size:1.15rem;
  display:flex;align-items:center;gap:8px;color:#2567a1;
}
#submit-project p.desc{margin:0 0 18px;font-size:.84rem;color:#4c5d6b;line-height:1.6;}

.simple-form{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:18px 26px;
}
.sf-field{display:flex;flex-direction:column;gap:6px;}
.sf-field label{
  font-size:.63rem;
  font-weight:700;
  letter-spacing:.5px;
  color:#4a5b66;
  text-transform:uppercase;
}
.sf-field input,.sf-field textarea,.sf-field select{
  border:1px solid #c9d9e6;
  background:#f7fbfe;
  border-radius:12px;
  padding:11px 12px 12px;
  font-size:.78rem;
  font-family:inherit;
  outline:none;
  transition:.18s;
}
.sf-field textarea{min-height:110px;resize:vertical;line-height:1.5;}
.sf-field input:focus,.sf-field textarea:focus,.sf-field select:focus{
  border-color:#4a90e2;
  background:#fff;
  box-shadow:0 0 0 2px rgba(74,144,226,.12);
}

.send-actions{
  margin-top:20px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
}
.send-actions button,.send-actions a{
  cursor:pointer;
  border:0;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:.75rem;
  font-weight:700;
  padding:11px 18px 12px;
  border-radius:12px;
  letter-spacing:.3px;
  transition:.2s;
}
.btn-wa{background:#25D366;color:#fff;box-shadow:0 4px 14px rgba(37,211,102,.35);}
.btn-wa:hover{background:#1db655;}
.btn-mail{background:#ff9800;color:#fff;box-shadow:0 4px 14px rgba(255,152,0,.35);}
.btn-mail:hover{background:#e08600;}
.btn-copy{background:#607d8b;color:#fff;box-shadow:0 4px 14px rgba(96,125,139,.35);}
.btn-copy:hover{background:#4f6975;}

.preview-box{
  margin-top:22px;
  background:#f5f9fc;
  border:1px solid #d2e2ee;
  padding:14px 16px 16px;
  border-radius:14px;
  font-size:.68rem;
  white-space:pre-wrap;
  direction:ltr;
  unicode-bidi:plaintext;
  color:#2a3d4b;
  position:relative;
}
.preview-box:before{
  content:"نص الرسالة المُولّد";
  position:absolute;
  top:-10px;
  right:14px;
  background:#4a90e2;
  color:#fff;
  font-size:.55rem;
  padding:4px 8px 5px;
  border-radius:20px;
  letter-spacing:.5px;
}

footer{
  position:fixed;
  bottom:0;right:0;left:0;
  background:#dee8f0;
  color:#007bff;
  font-size:0.7em;
  height:25px;
  display:flex;
  justify-content:center;
  align-items:center;
  line-height:1;
  box-shadow:0 -2px 8px rgba(0,0,0,0.04);
  z-index:999;
}
/* ===== توحيد شكل الأزرار في الديسكتوب مثل الموبايل (عمودي) ===== */
@media (min-width:760px){

  /* حاوية نص + أزرار داخل الكارت تضمن أن meta-row دائماً في الأسفل */
  .project-card .project-body{
    display:flex;
    flex-direction:column;
  }

  /* توحيد ارتفاع الوصف بحيث لا يختلف موضع الأزرار بين الكروت */
  .project-card .project-body p{
    min-height:60px; /* عدلها حسب متوسط سطورك */
    display:flex;
    align-items:flex-start;
    justify-content:center;
    text-align:center;
  }

  .project-card .meta-row{
    flex-direction:column !important;
    align-items:center !important;
    justify-content:flex-start;
    gap:10px;
    width:100%;
    padding-top:4px;
  }

  /* ضع الشارة فوق الأزرار أو تحتها حسب رغبتك */
  .project-card .meta-row .category-badge{
    order:-1; /* الشارة فوق */
    margin:0 0 4px 0;
  }

  /* عمود الأزرار */
  .project-card .meta-row .contact-group{
    display:flex;
    flex-direction:column;
    align-items:stretch;
    gap:6px;
    width:100%;
    max-width:170px; /* عرض ثابت موحد */
    margin:0 auto;
  }

  /* الأزرار كلها بعرض واحد */
  .project-card .meta-row .contact-group .contact-btn{
    width:100%;
    justify-content:center;
    min-height:36px;
    font-size:.64rem;
    border-radius:14px;
  }

  /* ضبط الرقم ليظهر متوازن (عرض ثابت تقريبي) */
  .project-card .meta-row .contact-group .contact-btn.phone .num{
    display:inline-block;
    min-width:95px; /* رقم افتراضي لتقليل اختلاف العرض */
    text-align:center;
  }
}
</style>
</head>
<body data-page="projects">

<header class="header" id="siteHeader">
  <div class="logo">
    <h1>بوابة الكنزاوية</h1>
    <p>دليل المشروعات</p>
  </div>
    <div style="width:100%;display:flex;justify-content:flex-start;align-items:center;padding-right:35px;margin-top:2px;">
        <a href="../index.html" class="icon-btn" data-tooltip="العودة للصفحة الرئيسية" style="background:rgba(255,255,255,0.2);color:#fff;font-size:2rem;margin-right:10px;">
            <i class="fas fa-home"></i>
        </a>
    </div>

</header>

<main class="main-content" id="main">
  <section class="section-card">
    <h2 class="page-title">
      <i class="fa-solid fa-layer-group" style="color:#4a90e2;"></i>
      <span>مشروعات الكنزاوية</span>
    </h2>
    <p class="page-intro">
      استعرض المشاريع والخدمات التي يقدمها بعض السكان داخل الكمبوند... يمكنك البحث والتصفية وإرسال طلب لإضافة مشروع جديد.
    </p>

    <!-- شريط الأدوات -->
    <div class="projects-toolbar">
      <div class="search-box" role="search">
        <i class="fa-solid fa-magnifying-glass"></i>
        <input id="searchInput" placeholder="ابحث باسم المشروع أو الوصف أو النوع..." aria-label="بحث"/>
      </div>

      <div class="filters" id="filters" aria-label="فلاتر التصنيف">
        <button class="filter-btn reflect active" data-filter="all"><i class="fa-solid fa-layer-group"></i> الكل</button>
        <button class="filter-btn reflect" data-filter="food"><i class="fa-solid fa-utensils"></i> مأكولات</button>
        <button class="filter-btn reflect" data-filter="agri"><i class="fa-solid fa-seedling"></i> زراعة</button>
        <button class="filter-btn reflect" data-filter="medical"><i class="fa-solid fa-kit-medical"></i> طبية</button>
        <button class="filter-btn reflect" data-filter="clothes"><i class="fa-solid fa-shirt"></i> ملابس</button>
        <button class="filter-btn reflect" data-filter="shoes_bags"><i class="fa-solid fa-bag-shopping"></i> أحذية/شنط</button>
        <button class="filter-btn reflect" data-filter="sports"><i class="fa-solid fa-dumbbell"></i> رياضية</button>
        <button class="filter-btn reflect" data-filter="home"><i class="fa-solid fa-house-chimney"></i> منزلية</button>
        <button class="filter-btn reflect" data-filter="handmade"><i class="fa-solid fa-gem"></i> أكسسوار</button>
        <button class="filter-btn reflect" data-filter="kids"><i class="fa-solid fa-children"></i> ترفيه أطفال</button>
        <button class="filter-btn reflect" data-filter="other"><i class="fa-solid fa-tag"></i> أخرى</button>
      </div>

      <div class="add-wrapper">
        <button id="toggleFormBtn" class="btn btn-outline" aria-expanded="false" aria-controls="submit-project">
          <i class="fa-solid fa-paper-plane"></i> طلب إضافة مشروع
        </button>
      </div>
    </div>

    <!-- شبكة المشروعات -->
    <div id="grid" class="projects-grid" aria-live="polite">
      <!-- مشروع 1 -->
      <article class="project-card" data-type="food">
        <div class="project-media">
          <img src="C.sweet.webp" alt="حلويات Sweet Cravings" loading="lazy">
        </div>
        <div class="project-body">
          <h3>Sweet Cravings</h3>
          <p>حلويات منزلية طازجة يوميًا (دونات، تشيز كيك، سينابون، مولتن كيك، كيك، وافل).</p>
          <div class="meta-row">
            <div class="contact-group">
              <a class="contact-btn phone" href="tel:01112396622"><i class="fa-solid fa-phone"></i><span class="num">01112396622</span></a>
              <a class="contact-btn wa" href="https://wa.me/201147459842" target="_blank" rel="noopener"><i class="fa-brands fa-whatsapp"></i><span class="lbl-ar">واتساب</span></a>
              <!-- لا يوجد فيسبوك حسب طلبك -->
            </div>
            <div class="category-badge food"><i class="fa-solid fa-utensils"></i><span>مأكولات</span></div>
          </div>
        </div>
      </article>

      <!-- مشروع 2 -->
      <article class="project-card" data-type="agri">
        <div class="project-media">
          <img src="S.plant.jpeg" alt="مشروع Sara's plant" loading="lazy">
        </div>
        <div class="project-body">
          <h3>Sara's plant Store</h3>
          <p>جميع انواع الشتلات واشجار الزينة والفواكه والنباتات العطرية والبوتات المعلقة وجميع انواع الزرع الداخلي </p>
          <div class="meta-row">
            <div class="contact-group">
              <a class="contact-btn phone" href="tel:01008864140"><i class="fa-solid fa-phone"></i><span class="num">01008864140</span></a>
              <a class="contact-btn wa" href="https://wa.me/201008864140" target="_blank" rel="noopener"><i class="fa-brands fa-whatsapp"></i><span class="lbl-ar">واتساب</span></a>
              <a class="contact-btn fb" href="https://www.facebook.com/profile.php?id=61566559271321&mibextid=ZbWKwL" target="_blank" rel="noopener"><i class="fa-brands fa-facebook-f"></i><span class="lbl-ar">فيسبوك</span></a>
            </div>
            <div class="category-badge agri"><i class="fa-solid fa-seedling"></i><span>زراعة</span></div>
          </div>
        </div>
      </article>

      <!-- مشروع 3 -->
      <article class="project-card" data-type="kids">
        <div class="project-media">
          <img src="XFun.jpg" alt="XFun" loading="lazy">
        </div>
        <div class="project-body">
          <h3>XFun</h3>
          <p>ألعاب تعليمية وترفيهية وأنشطة مبتكرة لتنمية مهارات الأطفال</p>
          <div class="meta-row">
            <div class="contact-group">
              <a class="contact-btn phone" href="tel:01040495927"><i class="fa-solid fa-phone"></i><span class="num">01040495927</span></a>
              <a class="contact-btn wa" href="https://wa.me/2011040495927" target="_blank" rel="noopener"><i class="fa-brands fa-whatsapp"></i><span class="lbl-ar">واتساب</span></a>
              <a class="contact-btn fb" href="https://www.facebook.com/share/1Qr5thqTQ2/" target="_blank" rel="noopener"><i class="fa-brands fa-facebook-f"></i><span class="lbl-ar">فيسبوك</span></a>
            </div>
            <div class="category-badge kids"><i class="fa-solid fa-children"></i><span>ترفيه أطفال</span></div>
          </div>
        </div>
      </article>

      <!-- ===== مشروع 4 (جديد) ===== -->
      <article class="project-card" data-type="home">
        <div class="project-media">
          <img src="maro.png" alt="Maro online shop - أدوات منزلية" loading="lazy">
        </div>
        <div class="project-body">
          <h3>Maro online shop</h3>
          <p>أدوات منزلية و كهربائية متنوعة ذات الاستخدام اليومي وكل ما يحتاجه البيت</p>
          <div class="meta-row">
            <div class="contact-group">
              <a class="contact-btn phone" href="tel:01276273761"><i class="fa-solid fa-phone"></i><span class="num">01276273761</span></a>
              <a class="contact-btn wa" href="https://wa.me/201276273761" target="_blank" rel="noopener"><i class="fa-brands fa-whatsapp"></i><span class="lbl-ar">واتساب</span></a>
              <!-- لا يوجد فيسبوك حسب طلبك -->
            </div>
            <div class="category-badge home"><i class="fa-solid fa-house-chimney"></i><span>منزلية</span></div>
          </div>
        </div>
      </article>
      <!-- ===== نهاية إضافة مشروع 4 ===== -->

    </div>
    <div id="emptyState" class="empty-state">لم يتم العثور على مشاريع تطابق بحثك أو الفلتر المختار.</div>
    <div id="submit-project" hidden>
      <div class="inner">
        <h3><i class="fa-solid fa-paper-plane"></i> طلب إضافة مشروع</h3>
        <p class="desc">املأ البيانات التالية ثم اختر وسيلة الإرسال. الحقول المعلّمة بنجمة مطلوبة.</p>

        <form id="requestForm" class="simple-form" onsubmit="return false;">
          <div class="sf-field">
            <label for="fName">اسم المشروع *</label>
            <input id="fName" required maxlength="60" placeholder="مثال: مخبوزات صحية">
          </div>

            <div class="sf-field">
            <label for="fType">النوع *</label>
            <select id="fType" required>
              <option value="food">مأكولات</option>
              <option value="agri">زراعة</option>
              <option value="medical">طبية</option>
              <option value="clothes">ملابس</option>
              <option value="shoes_bags">أحذية وشنط</option>
              <option value="sports">رياضية</option>
              <option value="home">منزلية</option>
              <option value="handmade">أكسسوار</option>
              <option value="kids">ترفيه أطفال</option>
              <option value="other">أخرى</option>
            </select>
          </div>

          <div class="sf-field">
            <label for="fPhone">رقم التليفون *</label>
            <input id="fPhone" required inputmode="numeric" pattern="^0\\d{9,10}$" placeholder="مثال: 01001234567">
          </div>

          <div class="sf-field">
            <label for="fWA">رقم واتساب (اختياري)</label>
            <input id="fWA" inputmode="numeric" pattern="^(?:0\\d{9,10}|201\\d{8,9})$" placeholder="مثال: 01112345678">
          </div>

          <div class="sf-field">
            <label for="fFB">رابط فيسبوك (اختياري)</label>
            <input id="fFB" placeholder="https://facebook.com/username">
          </div>

          <div class="sf-field">
            <label for="fContact">تواصل إضافي (اختياري)</label>
            <input id="fContact" placeholder="بريد أو رقم احتياطي">
          </div>

          <div class="sf-field" style="grid-column:1/-1;">
            <label for="fDesc">وصف مختصر (2-3 سطور) *</label>
            <textarea id="fDesc" required maxlength="220" placeholder="ما الذي تقدمه؟ المميزات؟ (لا تتجاوز 3 سطور)"></textarea>
          </div>
        </form>

        <div class="send-actions">
          <button id="btnWhatsApp" class="btn-wa"><i class="fa-brands fa-whatsapp"></i> إرسال واتساب</button>
          <a id="btnEmail" class="btn-mail" href="#"><i class="fa-solid fa-envelope"></i> إرسال بريد</a>
          <button id="btnCopy" class="btn-copy" type="button"><i class="fa-solid fa-copy"></i> نسخ النص</button>
        </div>

        <div id="preview" class="preview-box" tabindex="0"></div>
      </div>
    </div>

  </section>
</main>

<footer dir="rtl">
  <p>Copyright © 2024 GENIUS Tech All Rights Reserved</p>
</footer>

<script>
/* ضبط ارتفاع الهيدر */
(function(){
  const header = document.getElementById('siteHeader');
  function setHeaderHeight(){
    const h = header.offsetHeight;
    document.documentElement.style.setProperty('--header-height', h + 'px');
  }
  window.addEventListener('load', setHeaderHeight);
  window.addEventListener('resize', setHeaderHeight);
})();

/* بيانات أساسية */
const adminNumber='201001790590';
const adminEmail ='compoundkenz@gmail.com';

const searchInput = document.getElementById('searchInput');
const filters     = document.getElementById('filters');
const grid        = document.getElementById('grid');
const emptyState  = document.getElementById('emptyState');

/* عناصر النموذج */
const fName    = document.getElementById('fName');
const fType    = document.getElementById('fType');
const fPhone   = document.getElementById('fPhone');
const fWA      = document.getElementById('fWA');
const fFB      = document.getElementById('fFB');
const fDesc    = document.getElementById('fDesc');
const fContact = document.getElementById('fContact');
const preview  = document.getElementById('preview');

const btnWA    = document.getElementById('btnWhatsApp');
const btnEmail = document.getElementById('btnEmail');
const btnCopy  = document.getElementById('btnCopy');

const toggleFormBtn = document.getElementById('toggleFormBtn');
const formSection   = document.getElementById('submit-project');

const cards = () => Array.from(grid.querySelectorAll('.project-card'));

/* خريطة التصنيفات */
function labelForType(t){
  return ({
    food:'مأكولات',
    agri:'زراعة',
    medical:'طبية',
    clothes:'ملابس',
    shoes_bags:'أحذية وشنط',
    sports:'رياضية',
    home:'منزلية',
    handmade:'أكسسوار',
    kids:'ترفيه أطفال',
    other:'أخرى'
  })[t] || 'أخرى';
}

/* تطبيع رقم واتساب للصيغة الدولية المصرية */
function normalizeEgyptMobile(raw){
  if(!raw) return '';
  let digits = raw.replace(/\D/g,'');
  if(digits.startsWith('00')) digits = digits.slice(2);
  if(raw.startsWith('+')){
    if(raw.startsWith('+2')) digits = digits.slice(1);
  }
  if(digits.startsWith('0')) digits = '2' + digits;
  return digits;
}

/* بناء الرسالة */
function buildMessage(){
  const name    = fName.value.trim();
  const type    = labelForType(fType.value);
  const phone   = fPhone.value.trim();
  const waInput = fWA.value.trim();
  const fbLink  = fFB.value.trim();
  const desc    = fDesc.value.trim();
  const contact = fContact.value.trim();

  const errors = [];
  if(!name)  errors.push('اسم المشروع');
  if(!desc)  errors.push('الوصف');
  if(!phone) errors.push('رقم التليفون');

  if(errors.length){
    preview.textContent = 'أكمل الحقول المطلوبة: ' + errors.join(' - ');
    return null;
  }

  const waIntl = waInput ? normalizeEgyptMobile(waInput) : '';

  const SEP = '----------------------------------------';
  const NL  = '\r\n';

  const parts = [
    'طلب إضافة مشروع جديد إلى منصة مشروعات الكنزاوية',
    SEP,
    'الاسم: ' + name,
    'النوع: ' + type,
    'الوصف:',
    desc,
    'رقم التليفون: ' + phone,
    waInput ? ('رقم واتساب: ' + waInput + (waIntl ? ' (دولي: ' + waIntl + ')' : '')) : null,
    fbLink  ? ('رابط فيسبوك: ' + fbLink) : null,
    contact ? ('تواصل إضافي: ' + contact) : null,
    SEP,
    'أقر أن البيانات صحيحة ومناسبة للنشر.'
  ].filter(Boolean);

  return parts.join(NL);
}

/* تحديث المعاينة */
function updatePreview(){
  const msg = buildMessage();
  if(msg) preview.textContent = msg;
}

/* مستمعو التغيير */
['input','change','keyup'].forEach(ev=>{
  [fName,fType,fPhone,fWA,fFB,fDesc,fContact].forEach(el=> el.addEventListener(ev, updatePreview));
});
updatePreview();

/* البحث + الفلاتر */
function applySearchAndFilter(){
  const q = searchInput.value.trim().toLowerCase();
  const activeFilter = filters.querySelector('.filter-btn.active')?.dataset.filter || 'all';
  let shown = 0;
  cards().forEach(card=>{
    const type  = card.dataset.type;
    const title = card.querySelector('h3').textContent.toLowerCase();
    const desc  = card.querySelector('p').textContent.toLowerCase();
    const matchesFilter = (activeFilter === 'all') || (type === activeFilter);
    const matchesQuery  = !q || title.includes(q) || desc.includes(q) || type.includes(q);
    if(matchesFilter && matchesQuery){
      card.style.display='';
      shown++;
    } else {
      card.style.display='none';
    }
  });
  emptyState.style.display = shown === 0 ? 'block' : 'none';
}
searchInput.addEventListener('input', applySearchAndFilter);
filters.addEventListener('click', e=>{
  const btn = e.target.closest('.filter-btn');
  if(!btn) return;
  filters.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  applySearchAndFilter();
});
applySearchAndFilter();

/* إظهار/إخفاء النموذج */
toggleFormBtn.addEventListener('click', ()=>{
  const isHidden = formSection.hasAttribute('hidden');
  if(isHidden){
    formSection.removeAttribute('hidden');
    const fullHeight = formSection.scrollHeight + 'px';
    formSection.style.height='0px';
    formSection.style.opacity='0';
    requestAnimationFrame(()=>{
      formSection.style.height=fullHeight;
      formSection.style.opacity='1';
    });
    setTimeout(()=>{ formSection.style.height=''; }, 500);
    toggleFormBtn.innerHTML='<i class="fa-solid fa-xmark"></i> إخفاء النموذج';
    toggleFormBtn.setAttribute('aria-expanded','true');
    formSection.scrollIntoView({behavior:'smooth',block:'start'});
  }else{
    const currentHeight = formSection.scrollHeight + 'px';
    formSection.style.height=currentHeight;
    requestAnimationFrame(()=>{
      formSection.style.height='0px';
      formSection.style.opacity='0';
    });
    toggleFormBtn.innerHTML='<i class="fa-solid fa-paper-plane"></i> طلب إضافة مشروع';
    toggleFormBtn.setAttribute('aria-expanded','false');
    setTimeout(()=>{
      formSection.setAttribute('hidden','');
      formSection.style.height='';
      formSection.style.opacity='';
    },480);
  }
});

/* إرسال واتساب للأدمن */
btnWA.addEventListener('click', ()=>{
  const msg = buildMessage();
  if(!msg){ alert('أكمل الحقول المطلوبة.'); return; }
  const url='https://wa.me/'+adminNumber+'?text='+encodeURIComponent(msg);
  window.open(url,'_blank');
});

/* إعداد البريد */
btnEmail.addEventListener('click', ()=>{
  const msg = buildMessage();
  if(!msg){ alert('أكمل الحقول المطلوبة.'); return; }
  btnEmail.href = 'mailto:'+adminEmail+
    '?subject='+encodeURIComponent('طلب إضافة مشروع جديد')+
    '&body='+encodeURIComponent(msg);
});

/* نسخ النص */
btnCopy.addEventListener('click', ()=>{
  const msg = buildMessage();
  if(!msg){ alert('أكمل الحقول المطلوبة.'); return; }
  navigator.clipboard.writeText(msg).then(()=>{
    btnCopy.textContent='تم النسخ ✓';
    setTimeout(()=> btnCopy.innerHTML='<i class="fa-solid fa-copy"></i> نسخ النص',1600);
  });
});
</script>
</body>
</html>